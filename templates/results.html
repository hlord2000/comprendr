<!DOCTYPE html>
<html style="background-color: #01badb">
	<head>
		<title>Compress-Hension</title>
		<link rel="stylesheet" href="https://unpkg.com/tachyons@4.10.0/css/tachyons.min.css"/>
		<link rel="stylesheet" href="/static/main.css">
	</head>
	<body>
		<div id="player"></div>

	    <script>
	      // 2. This code loads the IFrame Player API code asynchronously.
	      var tag = document.createElement('script');

	      tag.src = "https://www.youtube.com/iframe_api";
	      var firstScriptTag = document.getElementsByTagName('script')[0];
	      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

	      // 3. This function creates an <iframe> (and YouTube player)
	      //    after the API code downloads.
	      var player;
	      function onYouTubeIframeAPIReady() {
	        player = new YT.Player('player', {
	          height: '390',
	          width: '640',
	          videoId: '{{ video_id }}',
	          events: {
	          	'onReady': onPlayerReady,
	          	'onStateChange': onChange
	        	}
	        });
	      }
    		var timestamps = JSON.parse({{ speeds|tojson }});
    		//document.querySelector('video').playbackRate = 3.0;
    		i = 0;
    		console.log("Changed fucking something :)");
    		function onPlayerReady(event) {
	    		
			}
			function onChange(event) {
				setInterval(function(){ 
					if (player.getPlayerState() == 1) {
						//This hurts my brain.
		    			if (player.getCurrentTime() >= timestamps[i][0]){
							player.setPlaybackRate(timestamps[i][1]);
							i++;
						}
						//This hurts my brain significantly more.  
						else if (player.getCurrentTime() <= timestamps[i-1][0]){
							i--;
						}
					}
				}, 10);
			}
		</script>
	</body>
	<footer>
		<p>Baked with love by: Helmut Lord, David Gordon, Taleb Hirani, and Melissa Hernandez</p>
		<p>Using Tachyons, Flask, and a 55-gallon drum of elbow grease</p>
	</footer>
</html>